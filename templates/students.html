{% extends "base.html" %}
{% block menu%}
    » Статистика по студентам
{% endblock %}
{% block links %}
    <link type="text/css" href="/static/css/cupertino/jquery-ui.css" rel="stylesheet"/>
    <script type="text/javascript" src="/static/scripts/jquery-ui.js"></script>
    <script type="text/javascript" src="/static/scripts/jquery.ui.datepicker-ru.js"></script>
{% endblock %}
{% block main %}
    <H2>Статистика по студентам</H2>
    {% include "searchform.html" %}
    <table id="rounded-corner">
        <thead>
        <tr>
            <th class="rounded-left">Учащийся</th>
            <th>Дата Тестирования</th>
            <th class="rounded-right">Результат</th>
        </tr>
        </thead>
        <tbody>
        {% for student in stats.keys %}
            {% if student in stats.keys %}
                {% for key, value in stats.items %}
                    {% if key == student %}
                        {% for test in value %}
                            <tr class="test">
                                {% if forloop.counter0 == 0%}
                                    <td rowspan="{{ value|length }}" valign="top" class="student"><img src="/static/images/student_icon.png" alt="Учащийся"> {{ student.first_name}}&nbsp;{{ student.last_name }}<br><a href="/statistics/chart/chapter/{{ 1 }}/student/{{ student.id }}/">Диаграмма</a></td>
                                {% endif %}
                                <td class="{% if test.final %}finaltest{% endif %}{% if test.total > test.correct %} testIncorrect{% else %} testCorrect{% endif %}">
                                    <a href="/statistics/test/{{ test.id }}/">{{ test.testDate|date:"j.m.Y" }}
                                    </a>
                                </td>
                                <td>
                                    {% if test.total > test.correct  %}
                                        <span class="highlight">Правильных ответов: {{ test.correct }}</span>
                                    {% else %}
                                        <span style="color:green;">Все ответы правильные!</span>
                                    {% endif %}
                                </td>
                            </tr>
                        {% endfor %}
                    {% endif %}
                {% endfor %}
            {% endif %}
        {% endfor %}
        {% if stats|length == 0 %}
            <tr><td colspan="3">По выбранным параметрам не удалось найти тестов</td></tr>
        {% endif %}
        </tbody>
    </table>
{% endblock %}