{% extends "base.html" %}
{% block menu%}
    » Статистика по студентам
{% endblock %}
{% block main %}
    <div id="searchform">
        <form method="GET">
            {% if form.non_field_errors %}
                <div>
                    {% for err in form.non_field_errors %}
                        <div class="errormessage">{{ err }}</div>
                    {% endfor %}
                </div>
            {% endif %}
            {% for field in form.visible_fields %}
                {% for err in field.errors %}
                    <div class="errormessage">{{ err }}</div>
                {% endfor %}
            {% endfor %}
            <ul>
                {% for field in form.visible_fields %}
                    <li {% if field.errors %}class="field_error"{% endif %}>
                        {{ field.label_tag }}
                        {{ field }}
                    </li>
                {% endfor %}
                <li>
                    <input type="submit" title="Найти" value="Найти">

                </li>
            </ul>

        </form>
    </div>
    <table id="rounded-corner">
        <thead>
        <tr>
            <th class="rounded-left">Учащийся</th>
            <th>Дата Тестирования</th>
            <th class="rounded-right">Результат</th>
        </tr>
        </thead>
        <tbody>
        {% for student in stats.keys %}
            {% if student in stats.keys %}
                {% for key, value in stats.items %}
                    {% if key == student %}
                        {% for test in value %}
                            <tr class="test">
                                {% if forloop.counter0 == 0%}
                                    <td rowspan="{{ value|length }}" valign="top" class="student"><img src="/static/images/student_icon.png" alt="Учащийся"> {{ student.first_name}}&nbsp;{{ student.last_name }}<br><a href="/statistics/chart/chapter/{{ 1 }}/student/{{ student.id }}/">Диаграмма</a></td>
                                {% endif %}
                                <td class="{% if test.final %}finaltest{% endif %}{% if test.total > test.correct %} testIncorrect{% else %} testCorrect{% endif %}">
                                    <a href="/statistics/test/{{ test.id }}/">{{ test.testDate|date:"j.m.Y" }}
                                    </a>
                                </td>
                                <td>
                                    {% if test.total > test.correct  %}
                                        <span class="highlight">Правильных ответов - {{ test.correct }}</span>
                                    {% else %}
                                        <span style="color:green;">Все ответы правильные!</span>
                                    {% endif %}
                                </td>
                            </tr>
                        {% endfor %}
                    {% endif %}
                {% endfor %}
            {% endif %}
        {% endfor %}
        </tbody>
    </table>
{% endblock %}